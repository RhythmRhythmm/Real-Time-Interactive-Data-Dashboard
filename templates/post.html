{% extends 'base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<section class="container mx-auto px-6 md:px-8 py-16 animated-section">
    <div class="bg-slate-800 p-10 rounded-2xl shadow-xl w-full max-w-4xl mx-auto border-2 border-slate-700">
        <!-- The image tag now includes an onerror attribute to handle broken links -->
        <img src="{{ post.thumbnail }}"
             alt="Post thumbnail"
             class="rounded-lg mb-8 w-full h-96 object-cover"
             onerror="this.onerror=null;this.src='https://placehold.co/600x400/slate-700/white?text=Image+Not+Found';">
        <h1 class="text-4xl md:text-5xl font-extrabold text-sky-400 mb-4">{{ post.title }}</h1>
        <div class="flex items-center space-x-4 text-slate-400 mb-8">
            <img src="{{ post.author.profile_image }}" alt="Author's profile picture" class="w-10 h-10 rounded-full object-cover">
            <p>By <a href="{{ url_for('profile', username=post.author.username) }}" class="text-white hover:underline">{{ post.author.username }}</a></p>
            <p>On {{ post.date_posted.strftime('%B %d, %Y') }}</p>
        </div>
        <div class="prose prose-invert max-w-none text-slate-300 leading-relaxed">
            <p>{{ post.content }}</p>
        </div>

        {% if post.author == current_user %}
        <div class="mt-8 flex space-x-4">
            <a href="{{ url_for('edit_post', post_id=post.id) }}" class="px-4 py-2 rounded-full bg-sky-500 text-white font-semibold hover:bg-sky-600 transition-colors duration-300">
                Edit Post
            </a>
            <form action="{{ url_for('delete_post', post_id=post.id) }}" method="POST" onsubmit="return confirm('Are you sure you want to delete this post?');">
                <button type="submit" class="px-4 py-2 rounded-full bg-red-500 text-white font-semibold hover:bg-red-600 transition-colors duration-300">
                    Delete Post
                </button>
            </form>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}
